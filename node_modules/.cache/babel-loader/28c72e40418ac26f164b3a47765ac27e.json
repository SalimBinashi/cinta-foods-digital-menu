{"ast":null,"code":"\"use strict\";\n\nvar assert = require(\"assert\");\n\nfunction FastPath(value) {\n  assert.ok(this instanceof FastPath);\n  this.stack = [value];\n} // The name of the current property is always the penultimate element of\n// this.stack, and always a String.\n\n\nFastPath.prototype.getName = function getName() {\n  var s = this.stack;\n  var len = s.length;\n\n  if (len > 1) {\n    return s[len - 2];\n  } // Since the name is always a string, null is a safe sentinel value to\n  // return if we do not know the name of the (root) value.\n\n  /* istanbul ignore next */\n\n\n  return null;\n}; // The value of the current property is always the final element of\n// this.stack.\n\n\nFastPath.prototype.getValue = function getValue() {\n  var s = this.stack;\n  return s[s.length - 1];\n};\n\nfunction getNodeHelper(path, count) {\n  var stackIndex = getNodeStackIndexHelper(path.stack, count);\n  return stackIndex === -1 ? null : path.stack[stackIndex];\n}\n\nfunction getNodeStackIndexHelper(stack, count) {\n  for (var i = stack.length - 1; i >= 0; i -= 2) {\n    var value = stack[i];\n\n    if (value && !Array.isArray(value) && --count < 0) {\n      return i;\n    }\n  }\n\n  return -1;\n}\n\nFastPath.prototype.getNode = function getNode(count) {\n  return getNodeHelper(this, ~~count);\n};\n\nFastPath.prototype.getParentNode = function getParentNode(count) {\n  return getNodeHelper(this, ~~count + 1);\n}; // Temporarily push properties named by string arguments given after the\n// callback function onto this.stack, then call the callback with a\n// reference to this (modified) FastPath object. Note that the stack will\n// be restored to its original state after the callback is finished, so it\n// is probably a mistake to retain a reference to the path.\n\n\nFastPath.prototype.call = function call(callback\n/*, name1, name2, ... */\n) {\n  var s = this.stack;\n  var origLen = s.length;\n  var value = s[origLen - 1];\n  var argc = arguments.length;\n\n  for (var i = 1; i < argc; ++i) {\n    var name = arguments[i];\n    value = value[name];\n    s.push(name, value);\n  }\n\n  var result = callback(this);\n  s.length = origLen;\n  return result;\n};\n\nFastPath.prototype.callParent = function callParent(callback, count) {\n  var stackIndex = getNodeStackIndexHelper(this.stack, ~~count + 1);\n  var parentValues = this.stack.splice(stackIndex + 1);\n  var result = callback(this);\n  Array.prototype.push.apply(this.stack, parentValues);\n  return result;\n}; // Similar to FastPath.prototype.call, except that the value obtained by\n// accessing this.getValue()[name1][name2]... should be array-like. The\n// callback will be called with a reference to this path object for each\n// element of the array.\n\n\nFastPath.prototype.each = function each(callback\n/*, name1, name2, ... */\n) {\n  var s = this.stack;\n  var origLen = s.length;\n  var value = s[origLen - 1];\n  var argc = arguments.length;\n\n  for (var i = 1; i < argc; ++i) {\n    var name = arguments[i];\n    value = value[name];\n    s.push(name, value);\n  }\n\n  for (var _i = 0; _i < value.length; ++_i) {\n    if (_i in value) {\n      s.push(_i, value[_i]); // If the callback needs to know the value of i, call\n      // path.getName(), assuming path is the parameter name.\n\n      callback(this);\n      s.length -= 2;\n    }\n  }\n\n  s.length = origLen;\n}; // Similar to FastPath.prototype.each, except that the results of the\n// callback function invocations are stored in an array and returned at\n// the end of the iteration.\n\n\nFastPath.prototype.map = function map(callback\n/*, name1, name2, ... */\n) {\n  var s = this.stack;\n  var origLen = s.length;\n  var value = s[origLen - 1];\n  var argc = arguments.length;\n\n  for (var i = 1; i < argc; ++i) {\n    var name = arguments[i];\n    value = value[name];\n    s.push(name, value);\n  }\n\n  var result = new Array(value.length);\n\n  for (var _i2 = 0; _i2 < value.length; ++_i2) {\n    if (_i2 in value) {\n      s.push(_i2, value[_i2]);\n      result[_i2] = callback(this, _i2);\n      s.length -= 2;\n    }\n  }\n\n  s.length = origLen;\n  return result;\n};\n\nmodule.exports = FastPath;","map":null,"metadata":{},"sourceType":"script"}